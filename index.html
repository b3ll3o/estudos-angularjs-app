<html lang="pt-br" ng-app='listaTelefonica'>

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aula 01</title>
    <link rel="stylesheet" href="libs/bootstrap.css">
    <link rel="stylesheet" href="css/app.css">
    
    <script src='libs/angular.js'></script>
    <script src='js/app.js'></script>
    <script src='js/services/listaTelefonicaService.js'></script>
    <script src='js/services/operadorasService.js'></script>
    <script src='js/services/configService.js'></script>
    <script src='js/services/serialGenerationProvider.js'></script>
    <script src='config/serialGenerationConfig.js'></script>
    <script src='filters/nameFilter.js'></script>
    <script src='filters/ellipsisFilter.js'></script>
    <script src='directives/uiAlertDirective.js'></script>

    <script src='js/controller/listaTelefonicaController.js'></script>
  </head>

  <body ng-controller='listaTelefonicaController'>
    <div class="jumbotron">
      <h3>{{app}}</h3>
      <input class="form-control"
        type='text' 
        ng-model='criterioDeBusca'
        placeholder="Buscar" />
        <ui-alert 
          title='Ops, aconteceu algo errado!'
          message='error'
          ng-if='error'></ui-alert>
           
      <table class="table" ng-show='contatos.length > 0'>
        <tr>
          <th></th>
          <th>Serial</th>
          <th><a href='' ng-click='ordenarPor("nome")'>Nome</a></th>
          <th><a href='' ng-click='ordenarPor("telefone")'>Telefone</a></th>
          <th><a href='' ng-click='ordenarPor("operadora")'>Operadora</a></th>
          <th><a href='' ng-click='ordenarPor("data")'>Data</a></th>
          <th></th>
        </tr>
        <tr 
          ng-repeat='contato in contatos | filter:{nome: criterioDeBusca} | orderBy: criterioOrdenacao : direcaoOrdenacao'
          ng-class='{"selecionado negrito": contato.selecionado}'>
          <td><input type="checkbox" ng-model='contato.selecionado'/></td>
          <td>{{contato.serial}}</td>
          <td>{{contato.nome | nameFilter | ellipsisFilter: 5}}</td>
          <td>{{contato.telefone}}</td>
          <td>{{contato.operadora.nome}}</td>
          <td>{{contato.data | date:'dd/MM/yyyy HH:mm'}}</td>
          <td>
            <div 
              class="color" 
              ng-style='{"background-color": contato.cor}'>
            </div>
          </td>
        </tr>
      </table>
      <form name='contatoForm' class="form-adicionar">
        <input class='form-control' 
          type='text' 
          ng-model='contato.nome'
          ng-required='true'
          name='nome' />
        <input class='form-control' 
          type='text' 
          ng-model='contato.telefone'
          ng-required='true'
          name='telefone'
          ng-pattern='/^\d{4,5}-\d{4}$/' />
        <select 
          class='form-control'
          ng-model='contato.operadora' 
          ng-options='operadora.nome group by operadora.categoria for operadora in operadoras' 
          ng-required='true'
          name='operadora'>
          <option  value="">Selecione uma operadora</option>
        </select>
        <div 
          class="alert alert-danger" 
          ng-show='contatoForm.nome.$error.required && contatoForm.nome.$dirty'>
          Preencha o campo Nome.
        </div>
        <div 
          class="alert alert-danger" 
          ng-show='contatoForm.telefone.$error.required && contatoForm.telefone.$dirty'>
          Preencha o campo Telefone.
        </div>
        <div 
          class="alert alert-danger" 
          ng-show='contatoForm.telefone.$error.pattern'>
          O campo nome deve ter um formato DDDDD-DDDD.
        </div>
        <div 
          class="alert alert-danger" 
          ng-show='contatoForm.operadora.$invalid && contatoForm.operadora.$dirty'>
          Preencha o campo Operadora.
        </div>
        <button 
          class="btn btn-primary btn-block"
          ng-click='adicionarContato(contato)'
          ng-disabled='contatoForm.$invalid' >
          Adicionar Contato
        </button>
        <button 
          class="btn btn-danger btn-block"
          ng-click='apagarContatos(contatos)'
          ng-disabled='!isContatosSelecionados(contatos)'>
          Apagar Contatos
        </button>
      </form>
    </div>
    <div ng-include='"view/rodape.html"'></div>
  </body>

</html>